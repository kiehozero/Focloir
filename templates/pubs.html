{% extends "main.html" %}

    {% block title %}
        Pubs
    {% endblock %}

    {% block content %}

    <!-- Search box taken from Code Institute task manager tutorial -->
    <div class="row center-align">
        <div class="col s12 m8 offset-m1">
            <form action="{{ url_for('search_pubs') }}" method="POST">
                <div class="row valign-wrapper center-align">

                    <!-- Search Box -->
                    <div class="input-field col s6 m8">
                        <input name="search" id="search" minlength="3"
                            class="validate" type="text" required>
                        <label for="search">Search by pub or location</label>
                    </div>

                    <!-- Buttons -->
                    <div class="s6 m4">
                        <a href="{{ url_for('pubs') }}" class="btn search-button" id="searchButton">Show All</a>
                        <button type="submit" class="btn search-button">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>

                </div>
            </form>
        </div>
    </div>

    <div class="row">
        <div class="col s12 m8 offset-m2">

            <!-- First tile is always the choice to add a new review -->
            <div class="col s12 m4">
                <div class="card">
                    <div class="card-image">
                        <img src="{{ url_for('static', filename='images/pintbaby-bg.png') }}">
                        <span class="card-title">Add a new pub</span>
                        <a 
                            class="btn-floating halfway-fab waves-effect waves-light right"
                            href="{{ url_for('add_pub') }}">
                            <i class="fas fa-pen-nib"></i>
                        </a>
                    </div>
                    <div class="card-content spectral">
                        <p>
                            {% if pubs|length == 0 %}
                                No pintbabies have visited this location, click the pen to add it!
                            {% else %}
                                Click the pen above to add a pub!
                            {% endif %}
                        </p>
                    </div>
                </div>
            </div>

            {% for pub in pubs %}
                <div class="col s12 m4">
                    <div class="card">
                        <div class="card-image">
                        <img src="{{ url_for('static', filename='images/pintbaby-bg.png') }}">
                        <span class="card-title">{{ pub.pname }}</span>
                        <a
                            class="btn-floating halfway-fab waves-effect waves-light left"
                            href="{{ url_for('add_review_of', pub_id=pub._id) }}">
                            <!--paramter above needs to be pub id-->
                            <!-- generate link here from pub id, a new template of the add_review that is pre-filled? -->
                            <div 
                                style="font-family: 'Fraunces'; font-weight: 600; font-size: 20px; text-align: center;">
                                <i class="fas fa-pen-nib"></i>
                            </div>
                        </a>
                        <a
                            class="btn-floating halfway-fab waves-effect waves-light"
                            href="{{ url_for('view_pub', pub_id=pub._id) }}">
                            <!--parameter above needs to be pub id-->
                            <i class="fas fa-book-open"></i>
                        </a>
                        </div>
                        <div class="card-content spectral">
                        <p>
                            {{ pub.city }}
                            <br>
                            {{ pub.country }}
                            <br>
                        </p>
                        </div>

                        {% if session.user == "pbadmin" %}
                            <!-- edit button that contains additional user form option for user, this 
                            will need to be pre-filled with the original editor's username so it isn't 
                            overwritten with the admin's name -->
                            <!-- below will need to be a new admin_edit_pub function-->
                            <div class="center-align admin-panel">
                                <a 
                                    class="btn review-card-button"
                                    href="#">
                                    Edit
                                </a>
                            </div>
                            <!-- styling in some margin bottom padding -->
                        {% endif %}

                    </div>
                </div>
            {% endfor %}

        </div>
    </div>

    {% endblock %}